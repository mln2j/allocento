<div class="tx-create-container" *ngIf="!loading; else loadingTpl">
  <mat-card class="tx-card">
    <div class="tx-header">
      <button mat-icon-button (click)="cancel()">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h2>New transaction</h2>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" class="tx-form">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Account</mat-label>
        <mat-select formControlName="accountId">
          <mat-option *ngFor="let acc of accounts" [value]="acc.id">
            {{ acc.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div class="row">
        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Type</mat-label>
          <mat-select formControlName="type">
            <mat-option value="expense">Expense</mat-option>
            <mat-option value="income">Income</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Amount</mat-label>
          <input matInput type="number" formControlName="amount" step="0.01" />
        </mat-form-field>
      </div>

      <div class="row">
        <mat-form-field appearance="outline" class="half-width">
          <mat-label>Date & time</mat-label>
          <input matInput type="datetime-local" formControlName="datetime" />
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <input matInput formControlName="description" />
      </mat-form-field>

      <div class="error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <div class="actions">
        <button mat-button type="button" (click)="cancel()">
          Cancel
        </button>
        <button
          mat-flat-button
          color="primary"
          type="submit"
          [disabled]="form.invalid || submitting">
          {{ submitting ? 'Saving...' : 'Save' }}
        </button>
      </div>
    </form>
  </mat-card>
</div>

<ng-template #loadingTpl>
  <div class="tx-loading">
    Loading...
  </div>
</ng-template>
